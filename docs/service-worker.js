const CACHE_NAME="berbagi-cerita-v1",urlsToCache=["./","./index.html","./app.bundle.js","./main.css","./favicon.png","./manifest.json","./icons/icon-192x192.png","./icons/icon-512x512.png"];self.addEventListener("install",(n=>{console.log("Service Worker installing..."),n.waitUntil(caches.open(CACHE_NAME).then((async n=>{for(const e of urlsToCache)try{await n.add(e),console.log("Cached:",e)}catch(n){console.warn("Gagal cache resource:",e,n)}})))})),self.addEventListener("activate",(n=>{console.log("Service Worker activating..."),n.waitUntil(caches.keys().then((n=>Promise.all(n.map((n=>n!==CACHE_NAME?(console.log("Menghapus cache lama:",n),caches.delete(n)):null))))))})),self.addEventListener("fetch",(n=>{n.respondWith(caches.match(n.request).then((e=>e||fetch(n.request))))})),self.addEventListener("push",(n=>{console.log("Service worker menerima push event:",n),n.waitUntil((async()=>{if(!n.data)return void await self.registration.showNotification("Cerita baru!",{body:"Ada cerita baru yang ditambahkan.",icon:"./icons/icon-192x192.png",badge:"./icons/icon-192x192.png"});let e;try{e=await n.data.json()}catch(e){return console.error("Gagal parse event.data JSON:",e),void await self.registration.showNotification("Cerita baru!",{body:n.data.text(),icon:"./icons/icon-192x192.png",badge:"./icons/icon-192x192.png"})}const i=e.title||"Dicoding Stories",a={body:e.options?.body||"Ada cerita baru yang ditambahkan.",icon:e.options?.icon||"./icons/icon-192x192.png",badge:e.options?.badge||"./icons/icon-192x192.png",data:e.options?.data||{}};await self.registration.showNotification(i,a)})())})),self.addEventListener("notificationclick",(n=>{n.notification.close(),n.waitUntil(clients.matchAll({type:"window",includeUncontrolled:!0}).then((n=>{for(const e of n)if(e.url.includes("/learning-path/")&&"focus"in e)return e.focus();return clients.openWindow?clients.openWindow("https://lusianasilaen.github.io/learning-path/"):null})))}));